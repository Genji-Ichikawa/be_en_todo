{% extends "main/base.html" %}
{% load static %}

{% block extra_style %}
  <link rel="stylesheet"
        type="text/css"
        href="{% static 'main/css/calendar.css' %}">
{% endblock extra_style %}

{% block content %}
  <h1>{{ year }}年 {{ month }}月のカレンダー</h1>
  <div class="link-container">
    <a href="?year={{ prev_year }}&month={{ prev_month }}">« 前の月</a> |
    <a href="?year={{ next_year }}&month={{ next_month }}">次の月 »</a>
  </div>
  <table border="1" cellpadding="5">
    <thead>
      <tr>
        <th class="weekday-sun">日</th>
        <th>月</th>
        <th>火</th>
        <th>水</th>
        <th>木</th>
        <th>金</th>
        <th class="weekday-sat">土</th>
      </tr>
    </thead>
    <tbody>
      {% for week in calendar_weeks %}
        <tr>
          {% for day in week %}
            {% if day.month == month %}
              {% if day == today %}
                <td class="today">
                  <a href="?year={{ year }}&month={{ month }}&day={{ day|date:'Y-m-d' }}" class="day-link">{{ day.day }}</a>
                </td>
              {% else %}
                <td>
                  <a href="?year={{ year }}&month={{ month }}&day={{ day|date:'Y-m-d' }}" class="day-link">{{ day.day }}</a>
                </td>
              {% endif %}
            {% else %}
              <td class="day--other-month">{{ day.day }}</td>
            {% endif %}
          {% endfor %}
        </tr>
      {% endfor %}
    </tbody>
  </table>
  {% if selected_day %}
    <hr>
    <h2>{{ selected_day }} のTodo</h2>
    {% if todos %}
      <ul>
        {% for todo in todos %}<li>{{ todo.title }}（{{ todo.deadline_time|date:"H:i" }}）</li>{% endfor %}
      </ul>
    {% else %}
      <p>この日に締切のTodoはありません。</p>
    {% endif %}
  {% endif %}
{% endblock content %}
